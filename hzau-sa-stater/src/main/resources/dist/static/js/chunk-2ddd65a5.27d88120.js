(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ddd65a5"],{"0fea":function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return n})),r.d(t,"f",(function(){return u})),r.d(t,"a",(function(){return o})),r.d(t,"g",(function(){return c}));r("b0c0");var a=r("b775");function i(){return Object(a["a"])({url:"/grade/allGrade",method:"get"})}function s(e){return Object(a["a"])({url:"/measuremanage/queryClassOfTeacher",method:"get",params:{grade:e.grade,teacherId:e.teacherId,name:e.name,page:e.pages,limit:"10"}})}function l(e){return Object(a["a"])({url:"/measuremanage/queryStudentOfClass",method:"get",params:{classId:e.classId,limit:"10",studentName:e.studentName,page:e.pages}})}function n(e){return Object(a["a"])({url:"/measuremanage/query",method:"get",params:{crop:e.crop,studentId:e.studentId}})}function u(e){return Object(a["a"])({url:"/measuremanage/insert",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}function o(e){return Object(a["a"])({url:"/measuremanage/delete/".concat(e),method:"delete"})}function c(e){return Object(a["a"])({url:"/measuremanage/update",method:"put",headers:{"Content-Type":"multipart/form-data"},data:e})}},"3e2c":function(e,t,r){},8001:function(e,t,r){"use strict";var a=r("3e2c"),i=r.n(a);i.a},c59d:function(e,t,r){"use strict";var a=r("cd61"),i=r.n(a);i.a},ca1f:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"index"},[r("div",{staticClass:"header"},[r("div",{staticClass:"left"},[r("p",{staticClass:"text"},[e._v("作物：")]),r("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeCrop},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("div",{staticClass:"right"},[r("el-button",{attrs:{size:"medium",round:""},on:{click:function(t){return e.resetForm(e.ruleForm)}}},[e._v("新增")]),r("el-button",{attrs:{size:"medium",round:""},on:{click:e.handleBack}},[e._v("返回")])],1),r("el-dialog",{attrs:{title:"新增措施",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"措施",prop:"measure",required:""}},[r("el-select",{attrs:{placeholder:"请选择措施"},model:{value:e.ruleForm.measure,callback:function(t){e.$set(e.ruleForm,"measure",t)},expression:"ruleForm.measure"}},e._l(e.ruleForm.options,(function(e){return r("el-option",{key:e.measure,attrs:{label:e.label,value:e.measure}})})),1)],1),r("el-form-item",{attrs:{label:"操作时间",required:""}},[r("el-col",{attrs:{span:11}},[r("el-form-item",{attrs:{prop:"date1"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期"},model:{value:e.ruleForm.date1,callback:function(t){e.$set(e.ruleForm,"date1",t)},expression:"ruleForm.date1"}})],1)],1)],1),r("el-form-item",{attrs:{label:"措施内容",prop:"desc"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:5}},model:{value:e.ruleForm.desc,callback:function(t){e.$set(e.ruleForm,"desc",t)},expression:"ruleForm.desc"}})],1),r("el-form-item",{attrs:{label:"添加图片"}},[r("el-upload",{ref:"upload",attrs:{action:"1","auto-upload":!1,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-change":e.handleAvatarChange,"file-list":e.ruleForm.pictureUrls,"list-type":"picture"}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["true"==e.determin?r("el-button",{attrs:{type:"primary"},on:{click:e.createNewMeasure}},[e._v("确 定")]):r("el-button",{attrs:{type:"primary"},on:{click:e.putMeasure}},[e._v("确 定")]),r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")])],1)],1)],1),r("div",{staticClass:"contain"},[r("h2",{staticClass:"text-contain"},[e._v("实训措施管理")]),r("div",{staticClass:"block"},[r("el-timeline",{attrs:{reverse:!0}},e._l(e.activities,(function(t,a){return r("el-timeline-item",{key:a,attrs:{placement:"top",type:"primary",timestamp:t.measureTime}},[r("el-card",{staticClass:"card"},[r("h2",[e._v(e._s(t.measureName))]),r("div",{staticClass:"text-picture"},[r("div",{staticClass:"measure-contain"},[e._v(" "+e._s(t.measureContent)+" ")]),r("div",{staticClass:"image-css"},[r("el-carousel",{attrs:{trigger:"click",height:"200px"}},e._l(t.pictureUrls,(function(t){return r("el-carousel-item",{key:t.pictureUrl},[r("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{fit:"scale-down",src:t.pictureUrl},on:{click:function(t){return t.preventDefault(),e.handlePictureCardPreview(a)}}})],1)})),1)],1)]),r("div",[r("el-dialog",{staticClass:"preview-card",attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-carousel",{staticClass:"preview-hover",attrs:{trigger:"click"}},e._l(e.PreviewPictureUrls,(function(e){return r("el-carousel-item",{key:e,staticClass:"preview-picture"},[r("img",{attrs:{width:"100%",src:e,alt:""}})])})),1)],1)],1),r("div",{staticClass:"button-contain"},[r("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleEdit(a)}}},[e._v("编辑")]),r("el-button",{attrs:{size:"small"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])],1)])],1)})),1)],1)])])},i=[],s=r("0fea"),l={data:function(){return{determin:"true",imageUrl:[],dialogVisible:!1,PreviewPictureUrls:[],deleteImage:[],dialogFormVisible:!1,formLabelWidth:"120px",measureManageId:"",activities:[],ruleForm:{crop:"",date1:"",desc:"",pictureUrls:[],measure:"浇水",options:[{measure:"浇水",label:"浇水"},{measure:"施肥",label:"施肥"},{measure:"播种",label:"播种"},{measure:"除草",label:"除草"},{measure:"松土",label:"松土"}]},rules:{measure:[{required:!0,message:"请选择操作",trigger:"change"}],date1:[{type:"string",required:!0,message:"请选择日期",trigger:"change"}],desc:[{required:!0,message:"请填写措施内容",trigger:"blur"}]},options:[{value:"水稻",label:"水稻"},{value:"小麦",label:"小麦"},{value:"玉米",label:"玉米"},{value:"棉花",label:"棉花"},{value:"油菜",label:"油菜"}],value:"玉米",input:""}},created:function(){this.newFetch()},methods:{newFetch:function(){var e=this,t={studentId:this.$store.getters.id,crop:this.value};Object(s["e"])(t).then((function(t){e.activities=t.data}))},handlePictureCardPreview:function(e){var t=this;this.PreviewPictureUrls=[];for(var r=0;r<this.activities[e].pictureUrls.length;r++)this.PreviewPictureUrls.push(this.activities[e].pictureUrls[r].pictureUrl);setTimeout((function(){t.dialogVisible=!0}),50)},changeCrop:function(){this.newFetch()},handleBack:function(){this.$router.go(-1)},resetForm:function(e){var t=this;this.determin="true",this.ruleForm.desc="",this.ruleForm.pictureUrls=[],setTimeout((function(){t.dialogFormVisible=!0}),200)},handleRemove:function(e,t){console.log(e),"false"==this.determin&&(this.deleteImage.push(e.pictureId),console.log(this.deleteImage))},handlePreview:function(e){console.log(e)},handleAvatarChange:function(e,t){this.ruleForm.pictureUrls.push(e),console.log(this.ruleForm.pictureUrls),console.log(t)},handleDelete:function(e){var t=this;console.log(this.activities[e].measureManageId),this.$confirm("确定要删除吗?删除后不能恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["a"])(t.activities[e].measureManageId).then((function(e){!0===e.data?t.$message({type:"success",message:"删除成功!"}):t.$message({type:"info",message:"删除失败!"}),t.newFetch()}))}))},changeValue:function(){console.log(this.ruleForm.value)},createNewMeasure:function(){var e=this;console.log("this is create"),this.dialogFormVisible=!1,console.log(this.ruleForm.date1),console.log(this.ruleForm.measure);var t=new window.FormData;t.append("crop","玉米"),t.append("createTime",this.ruleForm.date1),t.append("measureContent",this.ruleForm.desc),t.append("studentId","student"),t.append("measure",this.ruleForm.measure);for(var r=0;r<this.ruleForm.pictureUrls.length;r++)t.append("files",this.ruleForm.pictureUrls[r].raw);Object(s["f"])(t).then((function(t){console.log(t),e.newFetch()}))},handleEdit:function(e){var t=this;this.measureManageId=this.activities[e].measureManageId,console.log(this.measureManageId),this.determin="false",this.ruleForm.measure=this.activities[e].measureName,this.ruleForm.desc=this.activities[e].measureContent,this.ruleForm.date1=this.activities[e].measureTime,this.ruleForm.pictureUrls=[];for(var r=0;r<this.activities[e].pictureUrls.length;r++)this.ruleForm.pictureUrls.push({url:this.activities[e].pictureUrls[r].pictureUrl,pictureId:this.activities[e].pictureUrls[r].pictureId});setTimeout((function(){t.dialogFormVisible=!0}),200)},putMeasure:function(){var e=this;this.dialogFormVisible=!1;var t=new FormData;if(t.append("crop","玉米"),t.append("createTime",this.ruleForm.date1),t.append("measureContent",this.ruleForm.desc),t.append("measureManageId",this.measureManageId),t.append("measure",this.ruleForm.measure),0==this.ruleForm.pictureUrls.length)t.append("files",this.ruleForm.pictureUrls);else for(var r=0;r<this.ruleForm.pictureUrls.length;r++)t.append("files",this.ruleForm.pictureUrls[r].raw);t.append("ids",this.deleteImage),Object(s["g"])(t).then((function(t){console.log(t),e.measureManageId="",e.deleteImage=[],e.newFetch()}))}}},n=l,u=(r("8001"),r("c59d"),r("2877")),o=Object(u["a"])(n,a,i,!1,null,"84381f4c",null);t["default"]=o.exports},cd61:function(e,t,r){}}]);